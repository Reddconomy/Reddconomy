# Reddconomy [![Build Status](https://travis-ci.org/Reddconomy/Reddconomy.svg?branch=master)](https://travis-ci.org/Reddconomy/Reddconomy)  [![Docker Build (doge_amd64) Status](https://dockerbuildbadges.quelltext.eu/status.svg?organization=riccardoblb&repository=reddconomy-backend-testnet&tag=doge_amd64)](https://hub.docker.com/r/riccardoblb/reddconomy-backend-testnet-docker/builds/) [![Docker Build (rdd_amd64) Status](https://dockerbuildbadges.quelltext.eu/status.svg?organization=riccardoblb&repository=reddconomy-backend-testnet&tag=rdd_amd64)](https://hub.docker.com/r/riccardoblb/reddconomy-backend-testnet-docker/builds/)
Reddcoin-based economy for minecraft.

WORK IN PROGRESS

DO NOT USE THIS WITH REAL COINS
___________________________________________________


# Setting up the test environment
The latest snapshot of the master branch can be downloaded from [HERE](https://dl.bintray.com/reddconomy/Reddconomy/) or automatically with the following script
```bash
VERSION="`curl -L  https://dl.bintray.com/reddconomy/Reddconomy/Reddconomy_latest.txt`"

#Download sponge plugin
curl -L https://dl.bintray.com/reddconomy/Reddconomy/Reddconomy-sponge-$VERSION.jar -o Reddconomy-sponge.jar

#Download backend
curl -L https://dl.bintray.com/reddconomy/Reddconomy/Reddconomy-$VERSION.jar -o Reddconomy.jar
```

To run reddconomy you'll need  four components:
- A bitcoind (or fork!) daemon with RPC enabled (dogecoind, reddcoind ... ).
- The reddconomy backend (Reddconomy.jar)
- A MYSQL server (optional, currently not implemented)
- A [sponge](https://www.spongepowered.org/) server with the Reddconomy-sponge.jar plugin

## How things connect?

 - **(Bit)coind daemon** connects to the blockchain and exposes the *RPC interface* 
 - **Backend** connects to the *MySQL/SQLite* database and to **(Bit)coind daemon** and exposes the *HTTP Apis*
 - **The sponge Plugin** connects **ONLY** to **Backend**

 Since the backend and the sponge server can be hosted on different machines, the connection between the two is protected with a **secret key** generated at the first start by the backend and stored in *reddconomy.json*. You'll need this **secret key** to configure the plugin.


# Fastest way to run the backend with Docker

For simplicity we have a docker container that runs the latest backend snapshot, to use it, you need to:
1. Start the container (/srv/reddconomy_testnet is the path where the blockchain and other configuration files will be stored persistently)

__With Reddcoin__
```
docker run --name=reddconomy_test -d -p 8099:8099  -v /srv/reddconomy_testnet:/data --restart=always riccardoblb/reddconomy-backend-testnet-docker:rdd_amd64
```

__Or with Dogecoin__
```
docker run --name=reddconomy_test -d -p 8099:8099  -v /srv/reddconomy_testnet:/data --restart=always riccardoblb/reddconomy-backend-testnet-docker:doge_amd64
```

2. Get the **secret key** required to connect the plugin, save this somewhere, you'll need it later
```
docker exec -it reddconomy_test cat /data/reddconomy.json | grep secret
```
3. Wait for the blockchain to synchronize, you can check the status with
```
docker logs reddconomy_test --tail 50
```

#### Other useful commands
-  Get wallet info

```
docker exec -it reddconomy_test  bash -c '/opt/dogecoin/bin/dogecoin-cli   -conf="${DATA_DIR}/${CONFIG_FILE}" -datadir="${DATA_DIR}" getwalletinfo'
```

- Get available balance
```
docker exec -it reddconomy_test  bash -c '/opt/dogecoin/bin/dogecoin-cli  -conf="${DATA_DIR}/${CONFIG_FILE}" -datadir="${DATA_DIR}" getbalance'
```






# Configure the plugin
1. You'll need to have a running [sponge server](https://www.spongepowered.org/) check the official documentation for that
2. Copy the plugin in the mods/ directory
3. Start the server
4. Stop the server
5. Edit the newly generated config/reddconomy-sponge.conf to use the **secret key** generated by the backend
6. Start the server again
7. Done.



# Build from sources
Build backend
```bash
gradle buildBackend
```
Build plugin
```bash
gradle buildSpongePlugin
```

